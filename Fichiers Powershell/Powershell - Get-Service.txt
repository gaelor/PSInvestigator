Get-Service
https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-service?view=powershell-7



#Liste tous les services
Get-Service

#Liste les services commençant par "s" et les affiche triés suivant leur statut "Stopped" ou "Running"
Get-Service "s*" | Sort-Object status

#Liste tous les services et les affiche triés suivant leur statut "Stopped" ou "Running"
Get-Service | Sort-Object status


#Liste les services et les affiche triés suivant leur statut "Stopped" ou "Running", en commençant par Running (paramètre -descending)
Get-Service | Sort-object -descending status

#Get all the logs from distant computer
Get-Service -ComputerName nom_serveur 



#Liste les services "en cours" sur l'ordinateur distant alsidm 
Get-Service -ComputerName alsidm | Where Status -eq "Running" | Out-GridView


#Obtenir les dépendences d'un service
Get-Service "WinRM" -RequiredServices


Get-Service | Select -ExcludeProperty MachineName | Export-csv -Path "$env:TEMP\Get-Service_$(get-date -f dd-MM-yyyy).csv" -NoTypeInformation

Get-Service | Sort-Object -Property @{Expression = "Status"; Descending = $True}, @{Expression = "DisplayName"; Descending = $False}


================================================================================================================================================================
#FONCTIONNEL

#1 - Récupération de plusieurs services , triés par le statut "Running" / "Stopped" par ordre alphabétique
$catservice = Get-Service | Sort-object -Property @{Expression = "Status"; Descending = $True}, @{Expression = "DisplayName"; Descending = $False}
Foreach ($element in $catservice)
{
 $element
}
$catservice | Export-csv -Path "$env:TEMP\Get-Service_$(get-date -f dd-MM-yyyy).csv" -NoTypeInformation


#2
Get-Service | Sort-Object -Property @{Expression = "Status"; Descending = $True}
Foreach ($element in $catservice)
{
 $element
}
$catservice | Export-csv -Path "$env:TEMP\Get-Service_$(get-date -f dd-MM-yyyy).csv" -NoTypeInformation














